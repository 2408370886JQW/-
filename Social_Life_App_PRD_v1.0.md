# 社交生活服务 App 产品需求文档 (PRD)

| 文档版本 | V1.0 |
| :--- | :--- |
| 文档状态 | **已定稿 (基于现有原型)** |
| 撰写日期 | 2026-02-08 |
| 适用对象 | 前端开发、产品经理、UI/UE 设计 |

---

## 1. 产品概述
本产品是一款基于地理位置（LBS）的社交与本地生活服务应用。核心通过地图形态展示人（偶遇/好友）与内容（动态），并结合线下场景（相见/到店）提供从社交破冰到消费体验的完整闭环。

### 1.1 核心业务流程
1.  **发现：** 通过地图发现附近的人、好友和动态。
2.  **连接：** 查看用户资料，发起打招呼或查看详情。
3.  **场景：** 基于不同社交目的（约会、聚会等）推荐线下方案。
4.  **消费：** 模拟线下扫码进店，根据社交关系推荐专属套餐，完成支付并沉淀社交资产（发动态）。

---

## 2. 信息架构 (IA)

应用采用底部 Tab 导航结构，包含 5 个主要模块：

*   **首页 (Home)**
    *   顶部导航：搜索栏、好友列表入口、Tab 切换（偶遇 | 好友 | 动态 | 相见）
    *   **偶遇 (Encounter):** 地图模式，陌生人社交
    *   **好友 (Friends):** 地图模式，熟人社交
    *   **动态 (Moments):** 地图模式，LBS 内容
    *   **相见 (Meet):** 列表模式，场景化服务入口
*   **圈子 (Circles):** 兴趣社群列表
*   **发布 (Publish):** 内容发布入口
*   **消息 (Messages):** 聊天会话列表
*   **我的 (Profile):** 个人中心

---

## 3. 全局规范

### 3.1 视觉交互规范
*   **性别标识体系：**
    *   **男性：** 蓝色 (#3B82F6)，用于头像边框、标签背景等。
    *   **女性：** 粉色 (#EC4899)，用于头像边框、标签背景等。
*   **状态标识体系：**
    *   **在线：** 绿色圆点 (#22C55E) + 绿色呼吸光环（仅地图头像）。
    *   **近期在线（15分钟内）：** 黄色圆点 (#EAB308)。
    *   **离线：** 灰色圆点 (#9CA3AF)。
*   **地图交互：**
    *   点击 Marker：选中目标，从底部弹出详情卡片/浮层。
    *   点击地图空白处：收起所有弹出的卡片/浮层，恢复纯净地图视野。
    *   拖拽/缩放：标准手势操作。

---

## 4. 功能需求详解

### 4.1 首页 - 顶部公共区
*   **搜索栏：**
    *   **位置：** 顶部常驻。
    *   **功能：** 输入框支持搜索好友ID、套餐名称、商户名称。
    *   **交互：** 页面上滑时自动隐藏，下滑或点击地图空白处时显示。
*   **好友列表入口：**
    *   **位置：** 搜索栏右侧图标。
    *   **交互：** 点击右侧滑出「好友列表」抽屉，展示所有好友及其在线状态。

### 4.2 首页 - 偶遇 Tab (Encounter)
**核心功能：** 基于地图发现附近的陌生人。

1.  **地图展示：**
    *   显示当前视野内的用户头像 Marker。
    *   Marker 样式：圆形头像 + 性别颜色边框 + 状态圆点。在线用户有呼吸光环效果。
2.  **筛选功能 (Filter)：**
    *   **入口：** 地图右侧悬浮按钮。
    *   **交互：** 点击弹出半屏模态窗。
    *   **筛选维度：**
        *   **性别：** 全部 (默认) / 男生 / 女生。
        *   **年龄：** 18-22 / 23-26 / 27-35 / 35+。
        *   **星座：** 12 星座全选。
    *   **逻辑：** 点击「确认」后，地图 Marker 根据条件实时过滤刷新。
3.  **用户详情卡片：**
    *   **触发：** 点击地图上的用户 Marker。
    *   **样式：** 底部弹出半屏卡片 (Bottom Sheet)。
    *   **内容：**
        *   头像（带性别边框）、昵称、在线状态（带颜色标识）。
        *   距离显示（如 "距离 0.5km"）。
        *   标签墙（星座、兴趣，如 "双子座"、"摄影"）。
    *   **操作：**
        *   **打招呼 (Say Hi)：** 主按钮，点击触发打招呼逻辑（当前为 Log 输出）。
        *   **查看主页：** 次按钮，点击跳转用户个人主页。

### 4.3 首页 - 好友 Tab (Friends)
**核心功能：** 在地图上查看好友的实时位置。

1.  **地图展示：**
    *   仅展示好友列表中的用户 Marker。
    *   样式逻辑同「偶遇」Tab。
2.  **交互逻辑：**
    *   点击 Marker 弹出好友详情卡片（结构同用户详情卡片）。

### 4.4 首页 - 动态 Tab (Moments)
**核心功能：** 基于地理位置发现附近的生活动态。

1.  **地图展示：**
    *   Marker 样式：矩形图片缩略图 + 白色边框。
    *   显示逻辑：展示带有地理位置信息的动态图片。
2.  **动态详情弹窗：**
    *   **触发：** 点击动态 Marker。
    *   **样式：** 屏幕中央弹出卡片。
    *   **内容：**
        *   大图展示。
        *   发布者信息（头像、昵称）。
        *   动态文案。
        *   互动数据（点赞数、评论数）。
        *   浮动数据胶囊：显示在卡片右下角。
3.  **实时反馈：**
    *   支持监听 `new-moment-posted` 事件，新发布的动态会实时插入地图并聚焦。

### 4.5 首页 - 相见 Tab (Meet)
**核心功能：** 线下消费场景入口与商户推荐。

1.  **页面结构：**
    *   **顶部栏：** 返回按钮（返回偶遇 Tab）。
    *   **到店相见卡片（核心入口）：**
        *   背景：蓝紫渐变。
        *   按钮：「模拟扫码进店」。点击进入 **Store Mode** 流程。
    *   **场景推荐区：**
        *   展示 7 类社交场景图标：约会、闺蜜、兄弟、生日、商务、坐坐、深夜。
        *   点击图标可切换下方推荐方案（当前原型主要展示静态结构）。
    *   **推荐店铺列表：**
        *   展示附近的推荐商户卡片（占位图 + 标题）。

---

### 4.6 线下门店模式 (Store Mode)
**入口：** 首页-相见 Tab -> 点击「模拟扫码进店」。
**定位：** 模拟用户在线下扫描桌码后的完整交互流程。

#### 流程步骤：

1.  **扫码模拟页：**
    *   **展示：** 全屏扫描动画，模拟相机取景框扫描二维码。
    *   **逻辑：** 2秒后自动跳转至「场景选择页」。

2.  **场景选择页 (Scenario Selection)：**
    *   **标题：** "今天和谁相见？"
    *   **选项卡片：**
        *   **约会 (Date)：** 粉色系，配图浪漫。
        *   **好友 (Friend)：** 蓝色系，配图聚会。
        *   **家人 (Family)：** 橙色系，配图温馨。
        *   **独处 (Solitary)：** 灰色系，配图安静。
        *   **商务 (Business)：** 深色系，配图正式。
    *   **交互：** 点击任意卡片，跳转至「门店首页」。

3.  **门店首页 (Store Home)：**
    *   **商户信息：** 顶部展示商户名称（如 "Blue Bottle Coffee"）、评分、人均价格。
    *   **套餐推荐列表：**
        *   根据上一步选择的场景，展示对应的专属套餐（如选择了「约会」，展示 "浪漫双人下午茶"）。
        *   列表限制显示最多 3 个推荐项，减少决策成本。
    *   **交互：** 点击任意套餐卡片，进入「套餐详情页」。

4.  **套餐详情页 (Package Detail)：**
    *   **展示：** 套餐大图、标题、价格、详细描述（包含菜品明细）。
    *   **操作：** 底部悬浮「立即购买」按钮。
    *   **交互：** 点击「立即购买」，显示支付加载动画，1.5秒后跳转「支付成功页」。

5.  **支付成功页 (Payment Success)：**
    *   **状态：** 绿色成功图标，提示 "支付成功"。
    *   **核销码：** 展示模拟的二维码/条形码。
    *   **核心操作区：**
        *   **主按钮「记录此刻」(Record This Moment)：** 点击跳转至 **首页-动态 Tab**，模拟发布了一条刚才消费的动态（闭环社交）。
        *   **次按钮「返回相见」(Return to Meet)：** 点击返回 **首页-相见 Tab**，结束流程。

---

### 4.7 其他模块

*   **圈子 (Circles)：**
    *   展示 "我的圈子" 和 "推荐圈子" 列表。
    *   支持查看圈子热度与简介。
*   **发布 (Publish)：**
    *   点击底部 Tab 的 "+" 号进入。
    *   当前为基础占位页，提示发布功能。
*   **消息 (Messages)：**
    *   展示消息列表，包含系统通知与好友私信。
*   **我的 (Profile)：**
    *   展示用户个人信息头部（头像、昵称、ID）。
    *   展示社交数据：关注、粉丝、获赞与收藏。

---

## 5. 异常与边界情况

1.  **地图加载失败：**
    *   若 WebGL 环境不支持或网络异常导致 Google Maps 无法加载，系统应显示**静态地图背景图**作为兜底，并在此背景上通过绝对定位渲染用户 Marker，确保核心功能可用（已在截图生成逻辑中实现该降级方案）。
2.  **数据为空：**
    *   若当前区域无用户/动态，应显示空状态提示或引导用户移动地图。
    *   原型中已预置 Mock 数据（INITIAL_MARKERS）以保证演示效果。
3.  **权限：**
    *   Store Mode 流程无需真实摄像头权限，采用 CSS 动画模拟扫描效果。

## 6. 开发技术栈说明 (参考)
*   **框架：** React 19 + Vite
*   **样式：** Tailwind CSS 4
*   **地图：** Google Maps JavaScript API (通过 Proxy 代理访问)
*   **图标：** Lucide React
*   **动画：** Framer Motion (用于转场、弹窗、扫描动画)
*   **路由：** Wouter (轻量级路由)
